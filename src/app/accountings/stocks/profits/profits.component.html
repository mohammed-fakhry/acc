<!--table-->
<div class="container-fluid">
    <div class="row" style="padding-left: 20px;">
        <div class="col-md-2 ">
            <div class="stickyInp darkBg py-1 card">
                <div class="card">
                    <div class="panel-body panel-flex-table" style="height: fit-content;">
                        <table class="flex-table table table-hover">
                            <thead class="navHeader">
                                <tr>
                                    <th class="text-center">اسم المخزن</th>
                                </tr>
                            </thead>
                            <tbody class=" mt-3 tableBody">
                                <tr *ngFor="let stock of _stockService.stocks; let i = index">
                                    <td class="btn btn-light chooseBtn" id="showStockProfits{{i}}"
                                        (click)="showStockProfits(stock,i)" style="flex: 3;">{{stock.stockName}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card mt-4 p-2" id="totalProfits" style="display: none;">
                    <input [(ngModel)]="searchProd" placeholder="بحث باسم الصنف" class="form-control mb-2"
                        id="searchProd">
                    <hr>
                    <!-- style="height: 100%; margin-top: 0px; margin-bottom: 5px;" -->
                    <div>
                        <table class="table table-hover">
                            <thead class="navHeader">
                                <tr>
                                    <th scope="col">بيان</th>
                                    <th scope="col">قيمة</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">ارباح</th>
                                    <td class="bg-success text-light">{{totalAdd}}</td>
                                </tr>
                                <tr>
                                    <th scope="row">خسائر</th>
                                    <td class="bg-danger text-light">{{totalMin}}</td>
                                </tr>
                                <tr class="smokeBg">
                                    <th scope="row">مصاريف عمال</th>
                                    <td>{{employeeExpence}}</td>
                                </tr>
                                <tr class="bottomBorder smokeBg" style="border-bottom: solid 2px black;">
                                    <th scope="row">مصاريف متنوعة</th>
                                    <td>{{otherExpence}}</td>
                                </tr>
                                <tr>
                                    <th scope="row">صافى</th>
                                    <td class="lightBg p-2">{{totalProfit}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- <div>
                        <h5 class="lightBg p-2" style="border-radius: 5px;">صافى : {{totalProfit}}</h5>
                        <h5 class="bg-success p-2 text-light" style="border-radius: 5px;">ارباح : {{totalAdd}}</h5>
                        <h5 class="bg-danger p-2 text-light" style="border-radius: 5px;">خسائر : {{totalMin}}</h5>
                    </div>
                    <hr> -->
                    <hr>
                    <button class="btn btn-outline-info m-2" id="showProfitsPreBtn"
                        (click)='showStockProfitsPre(stockInfo)'>تفاصيل حركة
                        البيع</button>
                </div>
            </div>
        </div>
        <!-- |searchProdProfit:searchProd -->
        <!-- newCode -->
        <div class="col-md-10"
            style="display: none; height: 950px; overflow-y: auto; border-top: solid 3px rgb(22, 76, 117); border-bottom: solid 3px rgb(22, 76, 117);"
            id="productProfits">
            <div id="profitDetails" class="pt-1">
                <div *ngFor='let product of profitArr|searchProdProfit:searchProd; let i = index'
                    class="row mb-3 bg-light" style="padding: 10px 0;">
                    <div class="col-md-1 darkGrayBg shadow-lg" style="text-align: center; border-radius: 5px;">
                        <div class="text-center">
                            <h3 class="text-center pt-3">{{product.name}}</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="shadow card smokeBg">
                            <div class="panel-body panel-flex-table"
                                style="height: 100%; margin-top: 0px; margin-bottom: 5px;">
                                <table class="flex-table table table-hover">
                                    <thead class="navHeader">
                                        <tr>
                                            <th scope="col">السعر</th>
                                        </tr>
                                    </thead>
                                    <tbody class="tableBody" style="overflow-y: hidden;">
                                        <div id="soldProds">
                                            <tr class="bg-secondary text-white">
                                                <td></td>
                                                <th scope="row">
                                                    شراء
                                                </th>
                                                <th scope="row">
                                                    بيع
                                                </th>
                                            </tr>
                                            <tr class="text-success">
                                                <th>
                                                    <i class="fa fa-caret-up pl-2"></i>
                                                    اعلى
                                                </th>
                                                <td>{{product.in.maxPrice}}</td>
                                                <td>{{product.sold.maxPrice}}</td>
                                            </tr>
                                            <!--  -->
                                            <tr class="text-primary">
                                                <th class="darkGrayBg">
                                                    <i class="fa fa-sort"></i>
                                                    متوسط
                                                </th>
                                                <td class="darkGrayBg">{{product.in.avr}}</td>
                                                <td class="darkGrayBg">{{product.sold.avr}}</td>
                                            </tr>
                                            <tr class="text-danger">
                                                <th>
                                                    <i class="fa fa-caret-down pl-2"></i>
                                                    اقل
                                                </th>
                                                <td>{{product.in.minPrice}}</td>
                                                <td>{{product.sold.minPrice}}</td>
                                            </tr>
                                        </div>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- secCard -->
                    <div class="col-md-3">
                        <div class="card shadow smokeBg">
                            <div class="panel-body panel-flex-table"
                                style="height: 100%; margin-top: 0px; margin-bottom: 5px;">
                                <table class="flex-table table table-hover">
                                    <thead class="navHeader">
                                        <tr>
                                            <th scope="col">بيان</th>
                                            <th scope="col">كمية</th>
                                            <th scope="col">قيمة</th>
                                        </tr>
                                    </thead>
                                    <tbody class="tableBody" style="overflow-y: hidden;">
                                        <tr>
                                            <th scope="row">شراء</th>
                                            <td>{{product.in.qty}}</td>
                                            <td>{{product.in.qtyVal}}</td>
                                        </tr>
                                        <tr class="bottomBorder">
                                            <th scope="row">بيع</th>
                                            <td>{{product.sold.qty}}</td>
                                            <td>{{product.sold.qtyVal}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">متاح</th>
                                            <td>{{product.qtyRemain}}</td>
                                            <td>{{product.qtyRemainVal}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row" class="{{product.profits.profitsColor()}}">
                                                {{product.profits.profitCond()}}</th>
                                            <td class="{{product.profits.profitsColor()}}">{{product.profits.profit}}
                                            </td>
                                            <td class="{{product.profits.profitsColor()}}">{{product.profits.perc()}}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="card shadow smokeBg">
                            <h5 class="navHeader text-center p-2">ارباح رصيد باقى</h5>
                            <div class="panel-body panel-flex-table"
                                style="height: 100%; margin-top: 0px; margin-bottom: 5px;">
                                <table class="flex-table table">
                                    <thead class="bg-secondary text-white">
                                        <tr>
                                            <th scope="col" style="flex: 2;">بيان</th>
                                            <th scope="col">سعر</th>
                                            <th scope="col">متوقعة</th>
                                            <th scope="col">ربحية</th>
                                            <th scope="col">اجمالى ربح</th>
                                        </tr>
                                    </thead>
                                    <tbody class="tableBody" style="overflow-y: hidden;">
                                        <tr class="bottomBorder">
                                            <th scope="row" style="flex: 2;">اخر سعر بيع</th>
                                            <td>{{product.sold.lastPrice()}}</td>
                                            <td class="{{product.profitLastPrice.color()}}">
                                                {{product.profitLastPrice.val()}}</td>
                                            <td class="{{product.profitLastPrice.color()}}">
                                                {{product.profitLastPrice.percentage()}}</td>
                                            <td class="{{product.profitLastPrice.total.color()}}">
                                                {{product.profitLastPrice.total.val()}}</td>
                                        </tr>
                                        <tr class="darkGrayBg">
                                            <th scope="row" style="flex: 2;">سعر موصى به</th>
                                            <td>{{product.recommendedPrice.price()}}</td>
                                            <td>{{product.recommendedPrice.profit()}}</td>
                                            <td>{{product.recommendedPrice.percentage()}}</td>
                                            <td scope="col" class="{{product.recommendedPrice.total.color()}}">
                                                {{product.recommendedPrice.total.val()}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-10" id='customersProfits' style="display: none;">
            <div class="card" id="profitDetails">
                <div class="panel-body panel-flex-table" style="height: 950px;">
                    <table class="flex-table table table-hover">
                        <thead class="navHeader">
                            <tr>
                                <th>التاريخ</th>
                                <th>رقم الفاتورة</th>
                                <th style="flex: 2;">اسم العميل</th>
                                <th style="flex: 2;">الصنف</th>
                                <th>العدد</th>
                                <th>شراء</th>
                                <th>بيع</th>
                                <th>ربح</th>
                                <th>اجمالى ربح</th>
                            </tr>
                        </thead>
                        <tbody class=" mt-3 tableBody">
                            <tr *ngFor='let profit of profitArrCust; let i = index'>
                                <td>{{profit.date}}</td>
                                <td>{{profit.invNumber}}</td>
                                <td style="flex: 2;">{{profit.customerName}}</td>
                                <td style="flex: 2;">{{profit.productName}}</td>
                                <td>{{profit.Qty}}</td>
                                <td>{{profit.productCost}}</td>
                                <td>{{profit.price}}</td>
                                <td class="{{profit.color}}">{{profit.unitProfit}}</td>
                                <td class="{{profit.colorTotal}}">{{profit.totalProfit}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>